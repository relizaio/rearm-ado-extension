{
    "$schema": "https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json",
    "id": "a2dcce4a-0a30-4743-848f-f41aad705e3a",
    "name": "RearmReleaseInitialize",
    "friendlyName": "ReARM Release Initialize",
    "description": "Synchronizes branches, checks for changes, and initializes a pending release with ReARM",
    "helpMarkDown": "[Learn more about this task](https://github.com/relizaio/rearm-ado-extension)",
    "category": "Utility",
    "author": "Reliza Incorporated",
    "version": {
        "Major": 1,
        "Minor": 0,
        "Patch": 2
    },
    "instanceNameFormat": "Initialize Release with ReARM",
    "inputs": [
        {
            "name": "rearmApiKey",
            "type": "string",
            "label": "ReARM API Key",
            "required": true,
            "helpMarkDown": "API Key for ReARM authentication"
        },
        {
            "name": "rearmApiKeyId",
            "type": "string",
            "label": "ReARM API Key ID",
            "required": true,
            "helpMarkDown": "API Key ID for ReARM authentication"
        },
        {
            "name": "rearmUrl",
            "type": "string",
            "label": "ReARM URL",
            "required": true,
            "helpMarkDown": "ReARM server URL"
        },
        {
            "name": "repoPath",
            "type": "string",
            "label": "Repository Path",
            "defaultValue": ".",
            "required": false,
            "helpMarkDown": "Path to the repository (default: current directory)"
        },
        {
            "name": "branch",
            "type": "string",
            "label": "Branch",
            "required": false,
            "helpMarkDown": "Branch name (defaults to current branch from Build.SourceBranchName)"
        },
        {
            "name": "version",
            "type": "string",
            "label": "Version",
            "required": false,
            "helpMarkDown": "Version string for the release. If not provided, version will be obtained from ReARM using getversion command."
        },
        {
            "name": "createComponent",
            "type": "boolean",
            "label": "Create Component If Not Exists",
            "defaultValue": "false",
            "required": false,
            "helpMarkDown": "Create component if it doesn't exist. Requires organization-wide read-write API key."
        },
        {
            "name": "createComponentVersionSchema",
            "type": "string",
            "label": "Version Schema for New Component",
            "defaultValue": "semver",
            "required": false,
            "helpMarkDown": "Version schema for the new component. Only used with createComponent. Supported values: semver, calver_reliza, calver_ubuntu, calver_yy_mm, calver_yyyy_mm, calver_yy_0m, calver_yyyy_0m, or custom per Reliza Versioning."
        },
        {
            "name": "createComponentBranchVersionSchema",
            "type": "string",
            "label": "Branch Version Schema for New Component",
            "defaultValue": "semver",
            "required": false,
            "helpMarkDown": "Feature branch version schema for the new component. Only used with createComponent. Same supported values as Version Schema."
        },
        {
            "name": "allowRebuild",
            "type": "boolean",
            "label": "Allow Rebuild on CI Rerun",
            "defaultValue": "false",
            "required": false,
            "helpMarkDown": "Allow rebuilding release on repeated CI reruns. If true, when a release with the same version already exists, it will be rebuilt instead of rejected."
        }
    ],
    "outputVariables": [
        {
            "name": "DoBuild",
            "description": "Whether a build should be performed (true/false)"
        },
        {
            "name": "LastCommit",
            "description": "The last commit from the previous release"
        },
        {
            "name": "RearmFullVersion",
            "description": "Full version string from ReARM"
        },
        {
            "name": "RearmShortVersion",
            "description": "Docker-tag-safe version string from ReARM"
        }
    ],
    "execution": {
        "Node16": {
            "target": "index.js"
        },
        "Node20_1": {
            "target": "index.js"
        }
    }
}
